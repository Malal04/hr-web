<div class="form-container">
  <a routerLink="/admin/taches/listes" class="back-link">← Retour à la liste des tâches</a>

  <div class="form-card">
    <h2>Modifier la tâche</h2>
    <p class="subtitle">Modifiez les informations de la tâche sélectionnée.</p>

    <form [formGroup]="tacheForm" (ngSubmit)="onSubmit()">

      <div class="form-group">
        <label for="titre">Titre</label>
        <input id="titre" type="text" formControlName="titre">
        <div *ngIf="tacheForm.get('titre')?.invalid && tacheForm.get('titre')?.touched" class="auth__error">
          Le titre est requis.
        </div>
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" formControlName="description"></textarea>
        <div *ngIf="tacheForm.get('description')?.invalid && tacheForm.get('description')?.touched" class="auth__error">
          La description est requise.
        </div>
      </div>

      <div class="form-group">
        <label for="dateLimite">Date limite</label>
        <input id="dateLimite" type="date" formControlName="dateLimite">
        <div *ngIf="tacheForm.get('dateLimite')?.invalid && tacheForm.get('dateLimite')?.touched" class="auth__error">
          La date limite est requise.
        </div>
      </div>

      <div class="form-group">
        <label for="priority">Priorité</label>
        <select id="priority" formControlName="priority">
          <option [ngValue]="PriorityEtat.Basse">Basse</option>
          <option [ngValue]="PriorityEtat.Moyenne">Moyenne</option>
          <option [ngValue]="PriorityEtat.Haute">Haute</option>
          <option [ngValue]="PriorityEtat.Urgente">Urgente</option>
        </select>
      </div>

      <div class="form-group">
        <label for="etat">Statut</label>
        <select id="etat" formControlName="etat">
          <option [ngValue]="TacheEtat.EN_COURS">En cours</option>
          <option [ngValue]="TacheEtat.TERMINE">Terminée</option>
          <option [ngValue]="TacheEtat.ANNULEE">Annulée</option>
        </select>
      </div>

      <div class="form-group">
        <label for="assigneAId">Assigner à</label>
        <select id="assigneAId" formControlName="assigneAId">
          <option [ngValue]="null">-- Choisir un employé --</option>
          <option *ngFor="let emp of employes" [ngValue]="emp.id">
            {{ emp.nomComplete }} {{ emp.departementCode ? '('+emp.departementCode+')' : '' }}
          </option>
        </select>
      </div>

      <div class="form-group auth_button">
        <button type="submit" class="btn-save" [disabled]="tacheForm.invalid">Mettre à jour</button>
      </div>

    </form>

    <div *ngIf="message" class="auth__error">{{ message }}</div>
  </div>
</div>
